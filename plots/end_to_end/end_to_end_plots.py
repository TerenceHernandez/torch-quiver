import matplotlib.pyplot as plt
import numpy as np
import csv
import pandas as pd

keyword_map = {
	"sampling": "sampling",
	"features": "aggregating features",
	"training": "training"
}

def convert():
	sampling = [(10.657638311386108, 0.0019636154174804688, 4.607842445373535),
							(3.9406869411468506, 0.0022246837615966797, 0.44643068313598633),
							(4.317734479904175, 0.002295970916748047, 0.4462285041809082),
							(4.106448173522949, 0.001825094223022461, 0.4479806423187256),
							(4.552548170089722, 0.0022428035736083984, 0.4556715488433838),
							(4.429651737213135, 0.00225830078125, 0.44123172760009766),
							(4.571410417556763, 0.002236604690551758, 0.5106382369995117),
							(3.838006019592285, 0.0022470951080322266, 0.44701671600341797),
							(4.232720375061035, 0.002216815948486328, 0.45093297958374023),
							(4.79373836517334, 0.0022439956665039062, 0.49033260345458984),
							(4.4893317222595215, 0.002247333526611328, 0.4397308826446533),
							(4.292216062545776, 0.002256155014038086, 0.43988704681396484),
							(3.816441774368286, 0.0022389888763427734, 0.4450235366821289),
							(3.89359188079834, 0.0022385120391845703, 0.44605135917663574),
							(4.010328531265259, 0.0022437572479248047, 0.4410824775695801),
							(4.431525468826294, 0.0022847652435302734, 0.4739799499511719),
							(3.9286835193634033, 0.0023069381713867188, 0.4441549777984619),
							(4.524439334869385, 0.0022420883178710938, 0.48067450523376465),
							(3.8447325229644775, 0.002237081527709961, 0.43961381912231445),
							(4.608876466751099, 0.002217531204223633, 0.44270992279052734),
							(3.9679644107818604, 0.0022437572479248047, 0.448406457901001),
							(4.392585754394531, 0.002219676971435547, 0.4512033462524414),
							(3.9167871475219727, 0.0023598670959472656, 0.4503488540649414),
							(4.4946465492248535, 0.002291440963745117, 0.44128942489624023),
							(3.9154396057128906, 0.002257108688354492, 0.4430093765258789),
							(4.464858531951904, 0.0022459030151367188, 0.44505786895751953),
							(4.051429033279419, 0.0022568702697753906, 0.45604825019836426),
							(4.058828353881836, 0.002235889434814453, 0.4447932243347168),
							(4.041690111160278, 0.0025022029876708984, 0.4509763717651367),
							(4.439001560211182, 0.0022499561309814453, 0.4440882205963135),
							(4.401928901672363, 0.0022330284118652344, 0.44884729385375977),
							(4.386559009552002, 0.002262592315673828, 0.44397974014282227),
							(4.08907675743103, 0.0022361278533935547, 0.4441509246826172),
							(4.590435266494751, 0.0022597312927246094, 0.4727284908294678),
							(4.289986610412598, 0.0022487640380859375, 0.4475746154785156),
							(3.8188281059265137, 0.0019927024841308594, 0.4459986686706543),
							(4.466428995132446, 0.0022208690643310547, 0.4512758255004883),
							(4.076854467391968, 0.0022902488708496094, 0.4465813636779785),
							(4.351977348327637, 0.002241373062133789, 0.4404315948486328),
							(4.4959423542022705, 0.0023086071014404297, 0.466461181640625),
							(4.36803126335144, 0.0022356510162353516, 0.43920230865478516),
							(4.121821641921997, 0.002254009246826172, 0.44393086433410645),
							(4.379212379455566, 0.002165079116821289, 0.44255495071411133),
							(4.24242901802063, 0.002245187759399414, 0.43820858001708984),
							(4.370063304901123, 0.0022444725036621094, 0.4468095302581787),
							(4.527003288269043, 0.0022351741790771484, 0.4441211223602295),
							(3.9995620250701904, 0.0024182796478271484, 0.4442451000213623),
							(4.1360204219818115, 0.002248525619506836, 0.4495053291320801),
							(4.351395130157471, 0.0022733211517333984, 0.50917649269104),
							(3.9564483165740967, 0.0022542476654052734, 0.4394538402557373),
							(4.3345725536346436, 0.0020627975463867188, 0.45726728439331055),
							(4.17056131362915, 0.0022284984588623047, 0.44853782653808594),
							(4.1055426597595215, 0.0022368431091308594, 0.44240331649780273),
							(4.615655183792114, 0.0022649765014648438, 0.5145173072814941),
							(3.900287628173828, 0.0022630691528320312, 0.4498252868652344),
							(4.046842098236084, 0.0022454261779785156, 0.4473428726196289),
							(4.51338529586792, 0.002101898193359375, 0.4427216053009033),
							(4.1054487228393555, 0.0022292137145996094, 0.45200443267822266),
							(4.422101020812988, 0.0022513866424560547, 0.44315123558044434),
							(4.32515287399292, 0.0022444725036621094, 0.4403810501098633),
							(4.023095369338989, 0.0022275447845458984, 0.4394557476043701),
							(4.698683023452759, 0.0022399425506591797, 0.44680118560791016),
							(4.013610601425171, 0.002239704132080078, 0.44075965881347656),
							(4.584366798400879, 0.0022335052490234375, 0.4544205665588379),
							(3.9869754314422607, 0.002237558364868164, 0.44489288330078125),
							(3.611476421356201, 0.002405405044555664, 0.4378495216369629),
							(4.300147771835327, 0.002290964126586914, 0.44562339782714844),
							(4.037082672119141, 0.0018839836120605469, 0.44614624977111816),
							(4.3690879344940186, 0.0022211074829101562, 0.4420509338378906),
							(3.914315700531006, 0.0022275447845458984, 0.45101261138916016),
							(4.161685228347778, 0.002282857894897461, 0.4416656494140625),
							(4.032755136489868, 0.0022406578063964844, 0.45443105697631836),
							(4.12526798248291, 0.0023076534271240234, 0.4402182102203369),
							(4.30338978767395, 0.0022382736206054688, 0.4536168575286865),
							(3.6832711696624756, 0.0026242733001708984, 0.448699951171875),
							(4.0425732135772705, 0.0022704601287841797, 0.4494931697845459),
							(4.33700704574585, 0.002274036407470703, 0.46564817428588867),
							(3.9514105319976807, 0.002076387405395508, 0.447934627532959),
							(4.334944486618042, 0.0022270679473876953, 0.5004339218139648),
							(4.131269693374634, 0.0021533966064453125, 0.44643259048461914),
							(4.044432640075684, 0.0022127628326416016, 0.43970680236816406),
							(4.504368543624878, 0.0022585391998291016, 0.5181047916412354),
							(3.6823248863220215, 0.0024030208587646484, 0.4535038471221924),
							(4.429731130599976, 0.0022602081298828125, 0.4402179718017578),
							(4.020244598388672, 0.0022454261779785156, 0.4418678283691406),
							(4.2689528465271, 0.0022780895233154297, 0.4428410530090332),
							(4.042089462280273, 0.0018465518951416016, 0.4389309883117676),
							(4.449555397033691, 0.002267122268676758, 0.44939088821411133),
							(4.5131611824035645, 0.0022335052490234375, 0.44297289848327637),
							(4.359418153762817, 0.0023348331451416016, 0.45368099212646484),
							(4.245654106140137, 0.0025854110717773438, 0.46483278274536133),
							(4.160082101821899, 0.001873016357421875, 0.44402432441711426),
							(4.502326488494873, 0.002244710922241211, 0.45218420028686523),
							(4.137648344039917, 0.0022356510162353516, 0.45036911964416504),
							(4.117340087890625, 0.0022618770599365234, 0.45322608947753906),
							(4.408801317214966, 0.002225160598754883, 0.44333648681640625),
							(4.282234191894531, 0.002248525619506836, 0.45578837394714355),
							(4.647256851196289, 0.002254486083984375, 0.44640254974365234),
							(4.24874472618103, 0.0022454261779785156, 0.4469156265258789),
							(14.33806324005127, 0.0022575855255126953, 0.45401811599731445)]
	feature = [(5.699923276901245, 0.0006961822509765625, 4.682314157485962),
						 (1.2295103073120117, 0.0006880760192871094, 0.010671138763427734),
						 (1.055574893951416, 0.0006949901580810547, 0.009108781814575195),
						 (1.0123043060302734, 0.0006933212280273438, 0.009279727935791016),
						 (0.910775899887085, 0.0006988048553466797, 0.012546300888061523),
						 (0.7489006519317627, 0.000690460205078125, 0.015921592712402344),
						 (1.023970365524292, 0.0006935596466064453, 0.00939798355102539),
						 (1.2791175842285156, 0.0007011890411376953, 0.01177525520324707),
						 (0.9365243911743164, 0.0006921291351318359, 0.013307809829711914),
						 (0.685899019241333, 0.0006802082061767578, 0.008888959884643555),
						 (0.8078823089599609, 0.0006899833679199219, 0.009154796600341797),
						 (0.819267749786377, 0.0007016658782958984, 0.009346961975097656),
						 (1.0317151546478271, 0.0006997585296630859, 0.01176905632019043),
						 (1.075951099395752, 0.0006906986236572266, 0.009620428085327148),
						 (1.0196681022644043, 0.0006949901580810547, 0.00944209098815918),
						 (1.1161293983459473, 0.0006895065307617188, 0.009434700012207031),
						 (1.0971338748931885, 0.0006864070892333984, 0.010373353958129883),
						 (0.9802241325378418, 0.0007123947143554688, 0.00986337661743164),
						 (1.1768577098846436, 0.0006952285766601562, 0.012623786926269531),
						 (0.940903902053833, 0.0006945133209228516, 0.008991003036499023),
						 (1.0744116306304932, 0.0007078647613525391, 0.01303553581237793),
						 (1.2672145366668701, 0.0006935596466064453, 0.009740352630615234),
						 (1.2846324443817139, 0.0007021427154541016, 0.01043558120727539),
						 (1.0440459251403809, 0.000690460205078125, 0.018754243850708008),
						 (1.0513684749603271, 0.00069427490234375, 0.009946584701538086),
						 (0.9840960502624512, 0.0006794929504394531, 0.010536909103393555),
						 (0.9677517414093018, 0.0006933212280273438, 0.00896143913269043),
						 (0.9892501831054688, 0.0006749629974365234, 0.010477542877197266),
						 (0.9938955307006836, 0.0006799697875976562, 0.009948015213012695),
						 (0.9036393165588379, 0.0006873607635498047, 0.009084463119506836),
						 (1.146270751953125, 0.0006964206695556641, 0.010019302368164062),
						 (0.7514104843139648, 0.0006816387176513672, 0.00949406623840332),
						 (0.9606554508209229, 0.0006816387176513672, 0.010095357894897461),
						 (0.873206615447998, 0.0006892681121826172, 0.010673761367797852),
						 (0.9362597465515137, 0.0006873607635498047, 0.009586811065673828),
						 (1.0064687728881836, 0.0006844997406005859, 0.00888371467590332),
						 (0.9241640567779541, 0.0006976127624511719, 0.009220123291015625),
						 (0.96134352684021, 0.000682830810546875, 0.010023117065429688),
						 (0.7408127784729004, 0.0006806850433349609, 0.009038686752319336),
						 (0.9273116588592529, 0.0006902217864990234, 0.009287834167480469),
						 (0.7841007709503174, 0.0006885528564453125, 0.009823322296142578),
						 (0.8925960063934326, 0.0006897449493408203, 0.009234189987182617),
						 (1.0734939575195312, 0.0006968975067138672, 0.00932168960571289),
						 (0.7432436943054199, 0.0006759166717529297, 0.009537220001220703),
						 (0.8857810497283936, 0.0006866455078125, 0.009194135665893555),
						 (0.8972961902618408, 0.0006821155548095703, 0.009494781494140625),
						 (0.977515459060669, 0.0006766319274902344, 0.00907444953918457),
						 (1.0495514869689941, 0.0006916522979736328, 0.008998394012451172),
						 (1.1496503353118896, 0.0006921291351318359, 0.009204387664794922),
						 (1.064180850982666, 0.0006830692291259766, 0.01366877555847168),
						 (1.1557297706604004, 0.0006937980651855469, 0.016657352447509766),
						 (0.8842711448669434, 0.0006952285766601562, 0.011928558349609375),
						 (0.9741594791412354, 0.0006844997406005859, 0.009847879409790039),
						 (0.8168363571166992, 0.00067901611328125, 0.008317947387695312),
						 (1.060476541519165, 0.0006966590881347656, 0.009793758392333984),
						 (0.9935736656188965, 0.0006916522979736328, 0.015361785888671875),
						 (0.9863581657409668, 0.0006935596466064453, 0.009023189544677734),
						 (0.9643759727478027, 0.0006809234619140625, 0.00899648666381836),
						 (1.030872106552124, 0.0006952285766601562, 0.009681940078735352),
						 (0.8699665069580078, 0.0006852149963378906, 0.009278297424316406),
						 (0.8850820064544678, 0.0006842613220214844, 0.009103775024414062),
						 (0.9008994102478027, 0.0006890296936035156, 0.009892463684082031),
						 (1.0604686737060547, 0.0006883144378662109, 0.010221719741821289),
						 (0.9822418689727783, 0.0006961822509765625, 0.011326074600219727),
						 (1.097804069519043, 0.0006914138793945312, 0.010187625885009766),
						 (1.2130258083343506, 0.0006995201110839844, 0.014130592346191406),
						 (1.2082178592681885, 0.0007054805755615234, 0.00949549674987793),
						 (1.0588774681091309, 0.0006840229034423828, 0.00989675521850586),
						 (1.012716293334961, 0.0006890296936035156, 0.009330987930297852),
						 (1.1039001941680908, 0.0006792545318603516, 0.008743524551391602),
						 (1.0485310554504395, 0.0006887912750244141, 0.014263391494750977),
						 (0.9954135417938232, 0.0006990432739257812, 0.010534286499023438),
						 (1.0984599590301514, 0.0006923675537109375, 0.009801149368286133),
						 (0.9880249500274658, 0.0006902217864990234, 0.010869503021240234),
						 (1.3126604557037354, 0.0006868839263916016, 0.010089874267578125),
						 (1.0145537853240967, 0.0006849765777587891, 0.009076595306396484),
						 (1.0586388111114502, 0.0006997585296630859, 0.008662223815917969),
						 (1.1110384464263916, 0.0006852149963378906, 0.010861396789550781),
						 (1.032379388809204, 0.0006902217864990234, 0.009481668472290039),
						 (0.9978625774383545, 0.0006909370422363281, 0.009450912475585938),
						 (0.9950973987579346, 0.0006902217864990234, 0.009156942367553711),
						 (1.1098265647888184, 0.0006937980651855469, 0.008851051330566406),
						 (1.2573046684265137, 0.0006964206695556641, 0.009075403213500977),
						 (1.0925235748291016, 0.0006787776947021484, 0.009389162063598633),
						 (1.0675151348114014, 0.0006985664367675781, 0.010834217071533203),
						 (1.2335879802703857, 0.0007090568542480469, 0.00979304313659668),
						 (0.8982608318328857, 0.0006914138793945312, 0.009641170501708984),
						 (1.097191333770752, 0.0006906986236572266, 0.009426593780517578),
						 (0.7020032405853271, 0.0006737709045410156, 0.008949756622314453),
						 (0.97817063331604, 0.0006833076477050781, 0.008631467819213867),
						 (1.2542927265167236, 0.0006978511810302734, 0.008923768997192383),
						 (0.9997644424438477, 0.0006873607635498047, 0.009758710861206055),
						 (1.1010324954986572, 0.0006148815155029297, 0.011513710021972656),
						 (0.987898588180542, 0.0006937980651855469, 0.009569168090820312),
						 (1.0275695323944092, 0.0006902217864990234, 0.010315179824829102),
						 (1.0089504718780518, 0.0006940364837646484, 0.00925588607788086),
						 (0.8427393436431885, 0.0006837844848632812, 0.009292364120483398),
						 (1.0010647773742676, 0.0006937980651855469, 0.009261131286621094),
						 (1.056114673614502, 0.0006797313690185547, 0.011938810348510742),
						 (1.0329053401947021, 0.0006895065307617188, 0.01010751724243164)]
	training = [(3.5361974239349365, 0.005628347396850586, 1.3108329772949219),
							(2.251345634460449, 0.005555629730224609, 0.022345781326293945),
							(2.3051185607910156, 0.006067514419555664, 0.0151824951171875),
							(2.222440481185913, 0.005990266799926758, 0.016795873641967773),
							(2.2797024250030518, 0.00551152229309082, 0.03121471405029297),
							(2.0106794834136963, 0.005417585372924805, 0.02581167221069336),
							(2.240992784500122, 0.005820035934448242, 0.009853601455688477),
							(2.217315435409546, 0.005390644073486328, 0.01484370231628418),
							(2.090144395828247, 0.005495309829711914, 0.017627239227294922),
							(2.09600830078125, 0.0056645870208740234, 0.010575294494628906),
							(1.862830638885498, 0.005445718765258789, 0.013231039047241211),
							(2.0615334510803223, 0.005418300628662109, 0.01323246955871582),
							(2.28951096534729, 0.0061283111572265625, 0.014048337936401367),
							(2.2450666427612305, 0.005724668502807617, 0.010662078857421875),
							(2.278822422027588, 0.005628108978271484, 0.013008594512939453),
							(2.24164080619812, 0.0060040950775146484, 0.010394811630249023),
							(2.275195598602295, 0.005613088607788086, 0.01609206199645996),
							(2.26918625831604, 0.006220817565917969, 0.014357328414916992),
							(2.2904274463653564, 0.005644083023071289, 0.013570785522460938),
							(2.1675381660461426, 0.005496978759765625, 0.012777566909790039),
							(2.262918472290039, 0.0054531097412109375, 0.027476787567138672),
							(2.2233471870422363, 0.005525112152099609, 0.035886526107788086),
							(2.2294623851776123, 0.0059814453125, 0.013890504837036133),
							(2.262725591659546, 0.0055370330810546875, 0.018650293350219727),
							(2.295661687850952, 0.0061969757080078125, 0.019337177276611328),
							(2.2700233459472656, 0.005852460861206055, 0.029061317443847656),
							(2.2204971313476562, 0.00601506233215332, 0.016850948333740234),
							(2.2867095470428467, 0.006154298782348633, 0.028595447540283203),
							(2.18355131149292, 0.005414724349975586, 0.013311624526977539),
							(1.886791467666626, 0.005433797836303711, 0.01732325553894043),
							(2.2252137660980225, 0.005459785461425781, 0.020964860916137695),
							(2.0796430110931396, 0.005484819412231445, 0.02270054817199707),
							(2.2388458251953125, 0.005578756332397461, 0.02333998680114746),
							(2.1905784606933594, 0.005609750747680664, 0.0167391300201416),
							(2.136894702911377, 0.005427122116088867, 0.013926267623901367),
							(2.3020694255828857, 0.006731271743774414, 0.01814579963684082),
							(2.176748275756836, 0.0055234432220458984, 0.014887094497680664),
							(2.230067014694214, 0.005468845367431641, 0.012341022491455078),
							(2.0964102745056152, 0.005486965179443359, 0.010661602020263672),
							(2.1916720867156982, 0.005470752716064453, 0.012436151504516602),
							(2.05792498588562, 0.005469083786010742, 0.013894796371459961),
							(2.0793190002441406, 0.00577855110168457, 0.02329421043395996),
							(2.279614210128784, 0.006136417388916016, 0.014350175857543945),
							(2.1027321815490723, 0.0058667659759521484, 0.014963388442993164),
							(1.9780843257904053, 0.0054416656494140625, 0.02808856964111328),
							(2.2417781352996826, 0.005548000335693359, 0.01854705810546875),
							(2.2450759410858154, 0.005752086639404297, 0.018615007400512695),
							(2.148747205734253, 0.0054340362548828125, 0.012468338012695312),
							(2.130977153778076, 0.0054874420166015625, 0.013394594192504883),
							(2.2450172901153564, 0.005594968795776367, 0.01570415496826172),
							(2.312469244003296, 0.005525827407836914, 0.027847766876220703),
							(2.151571750640869, 0.005388498306274414, 0.02055501937866211),
							(2.2493019104003906, 0.00558781623840332, 0.027558088302612305),
							(2.1541080474853516, 0.006109476089477539, 0.010712146759033203),
							(2.2940807342529297, 0.00559687614440918, 0.029496431350708008),
							(2.2045819759368896, 0.005594015121459961, 0.011867523193359375),
							(2.212374687194824, 0.005631208419799805, 0.014954090118408203),
							(2.2427475452423096, 0.006038665771484375, 0.014474630355834961),
							(2.278825283050537, 0.006125450134277344, 0.014742374420166016),
							(2.053602695465088, 0.005425453186035156, 0.012466669082641602),
							(2.2979657649993896, 0.005950212478637695, 0.0204007625579834),
							(2.1692140102386475, 0.005916118621826172, 0.012283563613891602),
							(2.182360887527466, 0.005545616149902344, 0.014586210250854492),
							(2.173370361328125, 0.005547523498535156, 0.029882192611694336),
							(2.242093324661255, 0.005517244338989258, 0.014404058456420898),
							(2.3405988216400146, 0.006203413009643555, 0.019037246704101562),
							(2.2504842281341553, 0.005990743637084961, 0.01743483543395996),
							(2.2321221828460693, 0.0057582855224609375, 0.013573884963989258),
							(2.285773277282715, 0.005565643310546875, 0.018946409225463867),
							(2.2645204067230225, 0.006457328796386719, 0.017756223678588867),
							(2.1457109451293945, 0.005466938018798828, 0.015207052230834961),
							(2.2037763595581055, 0.005873680114746094, 0.014649152755737305),
							(2.1482787132263184, 0.005440711975097656, 0.018793821334838867),
							(2.2980287075042725, 0.00610661506652832, 0.024283647537231445),
							(2.3548715114593506, 0.00658869743347168, 0.012658357620239258),
							(2.260289192199707, 0.006167888641357422, 0.016037940979003906),
							(2.286522150039673, 0.00560760498046875, 0.014894247055053711),
							(2.317538261413574, 0.006183624267578125, 0.020275592803955078),
							(2.2736294269561768, 0.006559610366821289, 0.015430212020874023),
							(2.1297922134399414, 0.005464076995849609, 0.019331932067871094),
							(2.2343251705169678, 0.005467653274536133, 0.03133392333984375),
							(2.2442309856414795, 0.005650043487548828, 0.014629125595092773),
							(2.275895118713379, 0.0062103271484375, 0.010758161544799805),
							(2.2150654792785645, 0.0055332183837890625, 0.022828102111816406),
							(2.2384657859802246, 0.005628824234008789, 0.014632701873779297),
							(2.3541433811187744, 0.006529808044433594, 0.013181924819946289),
							(2.289768934249878, 0.006051301956176758, 0.018822669982910156),
							(2.227877140045166, 0.005874156951904297, 0.011350870132446289),
							(1.9174325466156006, 0.005449056625366211, 0.014503002166748047),
							(2.030975580215454, 0.005468845367431641, 0.015420675277709961),
							(2.244211196899414, 0.005442380905151367, 0.013188600540161133),
							(2.0803797245025635, 0.00544285774230957, 0.015284061431884766),
							(2.1106550693511963, 0.005416393280029297, 0.011651277542114258),
							(2.161585569381714, 0.005555391311645508, 0.010265350341796875),
							(2.188629150390625, 0.005381345748901367, 0.016284465789794922),
							(2.213088274002075, 0.005499362945556641, 0.01147007942199707),
							(2.204747438430786, 0.005966663360595703, 0.019304275512695312),
							(1.979769229888916, 0.005539655685424805, 0.011533021926879883),
							(1.9967613220214844, 0.0054607391357421875, 0.030643701553344727),
							(2.252549171447754, 0.005462169647216797, 0.01108860969543457)]
	epoch = [20.85002088546753, 8.263483047485352, 8.666535377502441, 8.23845911026001, 8.66616940498352,
					 8.06095814704895, 8.692549467086792, 8.275049448013306, 8.153858423233032, 8.432598114013672,
					 7.974326848983765, 8.03779911994934, 8.566579580307007, 8.155140161514282, 8.277022361755371,
					 8.634090423583984, 8.303942441940308, 8.656123638153076, 8.22376537322998, 8.675063371658325,
					 8.203750848770142, 8.816684246063232, 8.315734148025513, 8.723327875137329, 8.25125241279602,
					 8.609636068344116, 8.162791967391968, 8.684045553207397, 8.112892627716064, 8.059659004211426,
					 8.618054628372192, 8.149012565612793, 8.14893889427185, 8.594150066375732, 8.2099130153656,
					 7.978737115859985, 8.503004312515259, 8.176324367523193, 8.082415580749512, 8.512382984161377,
					 8.103617191314697, 7.937937259674072, 8.641045331954956, 7.933159112930298, 8.040798902511597,
					 8.585865020751953, 8.104625940322876, 8.219395160675049, 8.484766721725464, 8.141080141067505,
					 8.752215385437012, 8.050219535827637, 8.260836601257324, 8.355044603347778, 8.15468168258667,
					 8.1836256980896, 8.57207989692688, 8.271576404571533, 8.586353063583374, 8.08392071723938, 8.146722793579102,
					 8.63563084602356, 8.151093244552612, 8.575060367584229, 8.284047603607178, 8.031327486038208,
					 8.638566255569458, 8.245426416397095, 8.547861099243164, 8.24185061454773, 8.647616624832153,
					 8.087476968765259, 8.260906457901001, 8.424058437347412, 8.329265117645264, 8.218243598937988,
					 8.628857612609863, 8.253363609313965, 8.526285171508789, 8.155832052230835, 8.171718120574951,
					 8.775091648101807, 8.073045015335083, 8.622514486312866, 8.265890121459961, 8.738766193389893,
					 8.194977283477783, 8.648082494735718, 8.040425777435303, 8.229640483856201, 8.617371082305908,
					 8.119239807128906, 8.578034162521362, 8.185813903808594, 8.172889709472656, 8.523643493652344,
					 8.275611877441406, 8.479995012283325, 8.188637018203735, 18.493624448776245]

	with open('data/4_gpu_sampling.csv', 'w') as out:
		csv_out = csv.writer(out)
		csv_out.writerow(['total_across_epoch', 'min', 'max'])
		for row in sampling:
			csv_out.writerow(row)

	with open('data/4_gpu_features.csv', 'w') as out:
		csv_out = csv.writer(out)
		csv_out.writerow(['total_across_epoch', 'min', 'max'])
		for row in feature:
			csv_out.writerow(row)

	with open('data/4_gpu_training.csv', 'w') as out:
		csv_out = csv.writer(out)
		csv_out.writerow(['total_across_epoch', 'min', 'max'])
		for row in training:
			csv_out.writerow(row)

	x = pd.DataFrame(epoch)
	x.to_csv('data/4_gpu_epoch.csv', index=False)


def read_csv(file_name, uses_headers=True, usecols=None):
	return pd.read_csv(file_name, header=0 if uses_headers else None, usecols=usecols)


def end_end_stats_composition(stat='sampling'):
	ax = None
	for i in range(1, 4):
		df = read_csv(f'data/{i}_gpu_{stat}.csv', usecols=['total_across_epoch'])
		ax = df.plot(y='total_across_epoch', kind='line', ax=ax, label=f'{i} gpu{""if i == 1 else "s"}')

	ax.set_title(f"Time spent {keyword_map[stat]}")
	ax.set_xlabel("Epoch")
	ax.set_ylabel("Time in s")

	plt.show()


def end_end_stats():
	ax = None
	for i in range(1, 4):
		df = read_csv(f'data/{i}_gpu_epoch.csv', )
		ax = df.plot(kind='line', ax=ax, label=f'{i} gpu{"" if i == 1 else "s"}')

	ax.set_title(f"Time spent in total")
	ax.set_xlabel("Epoch")
	ax.set_ylabel("Time in s")
	plt.show()


def percentage_time_spent():

	for i in range(1, 4):
		operations = []
		label_vals = []
		for label in keyword_map.keys():
			df = read_csv(f'data/{i}_gpu_{label}.csv', usecols=['total_across_epoch'])
			operations.append(df['total_across_epoch'].sum())
			label_vals.append(keyword_map[label].capitalize())

		max_operation = max(operations)
		explode = [0.1 if operation == max_operation else 0.02 for operation in operations]

		fig1, ax1 = plt.subplots()
		ax1.pie(operations,
						explode=explode,
						labels=label_vals,
						autopct='%1.1f%%',
						shadow=True,
						startangle=90)
		ax1.axis('equal')

		ax1.set_title(f"Percentage time spent on each operation")
		plt.tight_layout()
		plt.show()


if __name__ == '__main__':
	end_end_stats_composition(stat='sampling')
	end_end_stats_composition(stat='features')
	end_end_stats_composition(stat='training')
	# TODO Maybe make use of the min/max?

	end_end_stats()

	percentage_time_spent()
